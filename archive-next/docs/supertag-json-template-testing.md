# Supertag JSON Template Testing Checklist

This checklist covers the migration of supertag templates from HTML to native Plate JSON.

---

## Setup

- [ ] Clear browser cache / hard refresh to ensure latest code is loaded
- [ ] Open the app in dev mode (`npm run dev`) or use deployed build
- [ ] Open browser DevTools console to watch for errors

---

## 1. New Card with Supertag (Template Application)

Test that each supertag applies its JSON template correctly when added to an empty card.

### Contact (`#contact`)
- [x] Create new card → Add `#contact` tag
- [x] Template appears with sections: Contact Info, Social & Gaming, Personal, Notes
- [x] Fields have proper "**Label:** " format with bold labels
- [x] No HTML tags visible in editor (no `<h2>`, `<ul>`, `<li>`)

### Subscription (`#subscription`)
- [x] Create new card → Add `#subscription` tag
- [x] Template appears with sections: Billing, Account, Notes
- [x] "Amount: $/month" placeholder visible
- [x] "Renews: (day of month)" placeholder visible

### Todo (`#todo`)
- [x] Create new card → Add `#todo` tag
- [x] Template appears with sections: Tasks, Notes
- [ ] Task section has functional checkbox
- No there's no functional checkbox in the TODO template. 
- [ ] Checkbox is clickable and toggles state
- No checkbox to text. 

TODO .md created after writing a todo in the task widget, doesn't have a checkbox. The widget works fine, but the .md note generated by the widget doesn't have a checkbox. The .md file should show checkboxes for each task, if they're checked off in the widget, they should also be checked off in the .md file.

### Recipe (`#recipe`)
- [x] Create new card → Add `#recipe` tag
- [x] Template appears with sections: Info, Ingredients, Instructions, Notes
- [x] Empty list items present for ingredients
- [x] Empty list items present for instructions

### Reading (`#reading`)
- [x] Create new card → Add `#reading` tag
- [x] Template appears with sections: Book Info, Progress, Quotes, Review, Notes
- [x] Quotes section has proper blockquote formatting
- [x] Review section has Rating and Would Recommend fields

### Project (`#project`)
- [x] Create new card → Add `#project` tag
- [x] Template appears with sections: Overview, Timeline, Goals, Resources, Notes
- [ ] Goals section has functional task checkbox
- No checkbox in the goals section
- [x] Status field shows "Planning / In Progress / On Hold / Completed"

### Meeting (`#meeting`)
- [x] Create new card → Add `#meeting` tag
- [x] Template appears with sections: Meeting Info, Attendees, Agenda, Decisions, Action Items, Notes
- [ ] Action Items section has functional task checkbox
- No functional checkbox
- [x] Meeting Info has Date, Time, Duration, Location, Meeting URL fields

### Habit (`#habit`)
- [x] Create new card → Add `#habit` tag
- [x] Template appears with sections: Habit Info, Streak, Notes
- [x] Frequency field shows "Daily / Weekly / Monthly"
- [x] Time of Day field shows "Morning / Afternoon / Evening"

### Wishlist (`#wishlist`)
- [x] Create new card → Add `#wishlist` tag
- [x] Template appears with sections: Item Info, Notes
- [x] Price field shows "$" placeholder
- [x] Category and Store URL fields present

### Warranty (`#warranty`)
- [x] Create new card → Add `#warranty` tag
- [x] Template appears with sections: Product Info, Warranty Info, Notes
- [x] Expiry Date field present
- [x] Warranty Type shows "Manufacturer / Extended / Store"

---

## 2. SupertagPanel Operations

For each supertag type, test the panel controls in the right sidebar.

### Adding Sections
- [x] Open card with any supertag → Open SupertagPanel in sidebar
- [x] Click "+" dropdown to see available sections
- [x] Add a section that's not currently in the card
- [x] Section appears in correct position (before Notes if Notes exists)
- [x] New section has proper JSON formatting (no HTML artifacts)
- [x] Section content is editable

### Removing Sections
- [x] Click the "X" button on a section header
- [x] Section is removed from content
- [x] Other content is preserved
- [x] Removed section appears in "Add section" dropdown again

### Reordering Sections
- [x] Use drag handles (⋮⋮) to drag a section up or down
- [x] Section moves to new position
- [x] Content within sections is preserved after reorder
Well, each line is a single section, so moving something like Warranty info, doesn't move all the items under it, since they're each indivdual lines, not blocks. But when I do move a line, it maintains it's formating and what not.
- [x] Save and reload - order is maintained

### Format Toggle (List ↔ Table)
- [x] Find the format toggle button (list/table icons)
- [x] Switch from list format to table format
- [ ] Content converts correctly to table layout
When you convert from a list to table, the template items persist. But if you've filled out the info, the info is lost and not converted to the table view. If you go back to list, that info is also gone. So it erases the content if you swap from one or the other. If we're going to leave it like this, we need a warning about that. 
- [ ] Field values are preserved during conversion
- [x] Switch back to list format
- [x] Content converts back correctly
- [ ] Values still preserved

### Template Type Switching
Test switching between template variants:

**Contact:**
- [x] Switch to "Personal" → sections: Contact Info, Social & Gaming, Personal, Notes
- [x] Switch to "Work" → sections: Contact Info, Work, Notes
- [x] Switch to "Gaming" → sections: Social & Gaming, Personal, Notes
- [x] Switch to "Family" → sections: Contact Info, Family, Personal, Notes
- [x] Switch to "Service" → sections: Business Info, Service Details, Notes

**Subscription:**
- [x] Switch to "Streaming" → sections: Billing, Account, Notes
- [x] Switch to "Software" → sections: Billing, License, Account, Notes
- [x] Switch to "Membership" → sections: Billing, Payment Method, Cancellation, Notes

**Recipe:**
- [x] Switch to "Quick" → sections: Info, Ingredients, Instructions, Notes
- [x] Switch to "Elaborate" → sections: Info, Equipment, Ingredients, Instructions, Notes
- [x] Switch to "Healthy" → sections: Info, Nutrition, Ingredients, Instructions, Notes

---

## 3. Quick Convert (Sidebar)

- [x] Create a new empty card (no content)
- [x] In the right sidebar, find the Quick Convert / supertag selector
- [x] Select a supertag to apply
- [x] JSON template is applied to the card
- [x] Template renders correctly in editor
- [x] No HTML visible in raw content

---

## 4. Legacy Content Compatibility

Test that existing HTML content still works:

- [x] Find or create a card with existing HTML content + supertag
- [x] Content displays correctly in editor
- [x] SupertagPanel can detect sections from HTML
- [x] SupertagPanel shows correct sections as "in use"
- [x] Add a new section → content converts gracefully
- [x] Remove a section → works correctly
- [x] Format toggle works on HTML content

One note, I had an amazon subscription that was made liek two weeks ago. So it's old content. It had the table that's generated when the user marks the subscription as paid in the bill widget. I removed the notes section from the right sidebar, that worked fine and the table moved up to it's spot. Then I readded the notes section, that worked fin as well. But the notes section was then under the table and I wanted to move the notes section back above the table, so I clicked on the little up arrow in the right side bar that bumps it up, when I did that, it erased the table. Not sure if that's an issue with old HTML content or just a bug in the template it'sself

---

## 5. Field Extraction & Quick Actions

Test that field extraction still works for supertag actions.

### Contact Actions
- [x] Create contact card with filled Phone field (e.g., "555-123-4567")
- [x] Create contact card with filled Email field (e.g., "test@example.com")
- [x] Quick actions appear: Call, Email, Message
- [x] Click "Call" → opens tel: link
- [x] Click "Email" → opens mailto: link

### Subscription Actions
- [x] Create subscription card with filled Website field
- [x] "Open Website" action appears
- [x] Click action → opens URL

### Meeting Actions
- [x] Create meeting card with filled Meeting URL field
- [x] "Join Meeting" action appears
- [x] Click action → opens meeting URL

### Warranty Actions
- [x] Create warranty card with filled Support URL
- [x] Create warranty card with filled Support Phone
- [x] Create warranty card with filled Support Email
- [x] Respective actions appear and work

---

## 6. Calendar & Widget Integration

Test that calendar field extraction still works:

### Birthdays Widget
- [x] Create `#contact` card → Fill Birthday field with a date
- [ ] Check birthdays widget → contact appears
We don't have a birthday widget yet. 

### Bills Widget
- [x] Create `#subscription` card → Fill Amount and Renews fields
- [x] Check bills widget → subscription appears with correct renewal date

### Todo Widget
- [ ] Create `#todo` card → Fill Due field with a date
Nope, when you create a todo card, it doesn't put that info into the todo Widget. But if you create a todo in teh task widget, it'll show int he todo card. 
- [ ] Check todo widget → task appears
It doesn't. 

### Calendar View
- [x] Create `#meeting` card → Fill Date field
- [x] Check calendar view → meeting appears on correct date

---

## 7. Edge Cases

### Content Preservation
- [ ] Create card → Add supertag → Remove supertag → Content remains intact
- [ ] Add content manually → Add supertag (should prompt) → Choose to keep content

### Multiple Supertags
- [ ] Add multiple supertags to same card
I tried to add another tag via the right sidebar. It was originally a todo supertag and I typed in contact. It gave me a prompt saying it'll use the new supertag template and replace everything. I clicked okay. It added the contact template to the card modal, but it kept the New To-do header and the todo tag. It didn't give it both tags
- [ ] First supertag's template is used
No, it used the second one. 
- [x] No errors or conflicts

### Special Characters
- [x] Enter field value with quotes: `John "The Boss" Doe`
- [x] Enter field value with newlines (if possible)
- [x] Enter field value with backslashes: `C:\Users\test`
- [x] Content saves and loads correctly
- [x] No JSON parsing errors in console

### Long Content
- [ ] Enter very long field values (100+ characters)
- [ ] No truncation or overflow issues
- [ ] Content saves completely

### Empty States
- [ ] View supertag template with all fields empty
- [ ] Renders without errors
- [ ] Placeholders visible where expected

---

## 8. Console Error Check

Throughout all testing:

- [ ] No JavaScript errors in console related to templates
- [ ] No JSON parsing errors
- [ ] No "undefined" or "null" rendering in content
- [ ] No React key warnings related to supertag sections

---

## Pass Criteria

✅ **All templates render as JSON** - No `<h2>`, `<ul>`, `<li>` HTML tags visible in raw content

✅ **All interactive elements work** - Checkboxes toggle, links work

✅ **SupertagPanel operations work** - Add, remove, reorder, format toggle, type switch

✅ **Field extraction works** - Quick actions appear when fields are filled

✅ **Calendar integration works** - Dates appear in widgets/calendar

✅ **Legacy compatibility** - Old HTML content still displays and is editable

✅ **No console errors** - Clean console during all operations

---

## Notes

_Use this space to record any issues found during testing:_

| Issue | Supertag | Steps to Reproduce | Severity |
|-------|----------|-------------------|----------|
|       |          |                   |          |
|       |          |                   |          |
|       |          |                   |          |

---

## Fixes Applied

### Commit `0cb19279` - fix(supertags): Use correct Plate todo structure for checkboxes
- **Issue**: Task checkboxes weren't rendering in Todo, Project, Meeting, and Habit templates
- **Cause**: `taskItem()` was creating `{ type: 'action_item' }` nodes which Plate doesn't render
- **Fix**: Changed to use `{ type: 'p', listStyleType: 'todo', checked }` which matches Plate's list plugin

### Commit `7f933bc7` - fix(supertags): Preserve field values when switching list/table format
- **Issue**: User-entered data was lost when toggling between list and table format
- **Cause**: `handleFormatChange` rebuilt templates from scratch without preserving values
- **Fix**: Added `extractFieldValues()` to parse current content and `applyFieldValues()` to inject values into new template

### Known Remaining Issues

1. **Section reordering behavior**: Each line moves independently, not as blocks. This is by design - each field is a separate Plate node.

2. **Legacy content table erasure**: When reordering sections with old HTML content that includes tables (e.g., payment history), the table may be lost. This is a limitation of the HTML→JSON conversion during reordering.

3. **Multiple supertags**: When switching supertags via sidebar, the first tag's title remains. Requires separate fix to handle tag switching properly.

4. **Todo widget sync**: Creating a #todo card doesn't sync to the Todo Widget. The sync is one-way (widget → card). This is a feature gap, not a template issue.
